<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EROÄLU | Servis YÃ¶netimi</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;400;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{
--primary:#FF5733;
--bg:#0A0A0A;
--card:#1C1C1C;
--text:#F0F0F0;
--primary-dark:#CC472A;
--muted:#888;
--border:#333;
--shadow:0 5px 20px rgba(0,0,0,0.8);
--header-bg:var(--card);
--sidebar-bg:var(--card);
--font-body:'Poppins', sans-serif;
}
*{box-sizing:border-box;}
html,body{margin:0;height:100%;font-family:var(--font-body);background:var(--bg);color:var(--text);}
#splash{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;background:var(--bg);z-index:9999;transition:opacity 0.5s;}
.splash-title{font-size:clamp(60px,14vw,120px);font-weight:900;color:var(--primary);text-shadow:0 0 8px var(--primary);animation:textReveal 1s ease both;}
@keyframes textReveal{from{opacity:0;transform:translateY(20px);filter:blur(10px);}to{opacity:1;transform:translateY(0);filter:blur(0);}}
.header{height:60px;display:flex;align-items:center;padding:0 20px;background:var(--header-bg);border-bottom:1px solid var(--border);position:fixed;top:0;left:0;right:0;z-index:900;box-shadow:var(--shadow);}
.header .brand{font-weight:900;font-size:1.6rem;color:var(--primary);}
.hamburger{font-size:1.5rem;cursor:pointer;margin-right:15px;}
.sidebar{width:240px;height:calc(100vh - 60px);background:var(--sidebar-bg);padding:15px 0;position:fixed;top:60px;left:0;border-right:1px solid var(--border);transition:transform .3s;z-index:800;box-shadow:2px 0 5px rgba(0,0,0,0.5);}
.sidebar.hidden{transform:translateX(-100%);}
.side-btn{display:flex;align-items:center;gap:15px;padding:15px 20px;border:none;background:transparent;color:var(--text);cursor:pointer;width:100%;text-align:left;transition:0.2s;}
.side-btn:hover{background:#282828;color:var(--primary);}
.side-btn.active{background:var(--primary);color:var(--card);}
.main{margin-left:240px;padding:30px;min-height:calc(100vh - 60px);transition:margin-left .3s;}
.panel-content{display:block;}
.hidden-panel{display:none;}
.card{background:var(--card);padding:25px;border-radius:2px;border:1px solid var(--border);box-shadow:var(--shadow);margin-bottom:25px;}
.grid-3{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;}
.stat-card{padding:20px;border-radius:2px;background:var(--card);border-left:5px solid var(--primary);box-shadow:0 2px 5px rgba(0,0,0,0.3);}
.stat-title{font-size:0.9rem;color:var(--muted);margin-bottom:8px;text-transform:uppercase;}
.stat-value{font-weight:900;font-size:2.5rem;color:var(--primary);}
.form-row{display:flex;gap:15px;margin-bottom:15px;flex-wrap:wrap;align-items:center;}
.input,.select,.textarea{padding:12px 15px;border-radius:2px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:1rem;width:100%;transition:0.2s;}
.input:focus,.select:focus,.textarea:focus{border-color:var(--primary);outline:none;}
.textarea{resize:vertical;min-height:80px;}
.btn{padding:12px 20px;border:none;border-radius:2px;cursor:pointer;background:var(--primary);color:var(--card);font-weight:600;transition:0.2s;}
.btn:hover{background:var(--primary-dark);}
.btn-secondary{background:var(--muted);}
.btn-secondary:hover{background:#606060;}
.label{width:150px;color:var(--muted);font-weight:600;}
.table{width:100%;border-collapse:collapse;margin-top:15px;}
.table th,.table td{padding:15px;border-bottom:1px solid var(--border);text-align:left;}
.table th{background:var(--bg);color:var(--primary);font-weight:700;}
.table tbody tr:hover{background:rgba(255,87,51,0.05);}
.badge{display:inline-block;padding:4px 10px;border-radius:2px;font-size:0.8rem;font-weight:600;}
.badge.active{background:#28a745;color:#fff;}
.badge.passive{background:#dc3545;color:#fff;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:0.3s;}
.modal.visible{opacity:1;pointer-events:auto;}
.modal-box{width:90%;max-width:400px;background:var(--card);padding:30px;border-radius:2px;border:1px solid var(--primary);}
@media(max-width:900px){.sidebar{width:100%;height:calc(100vh-60px);top:60px;}.main{margin-left:0;padding:15px;}}
</style>
</head>
<body>

<div id="splash"><div class="splash-title">EROÄLU</div></div>

<header class="header">
<span class="hamburger" id="hambBtn">&#9776;</span>
<div class="brand">EROÄLU</div>
</header>

<nav id="sidebar" class="sidebar hidden">
<button class="side-btn active" data-panel="dashboard">ğŸ“Š Servis Ã–zeti</button>
<button class="side-btn" data-panel="records">ğŸ“‘ Servis KayÄ±tlarÄ±</button>
<button class="side-btn" data-panel="add">â• Yeni Servis</button>
<button class="side-btn" data-panel="settings">ğŸ› ï¸ Ayarlar</button>
<button class="side-btn" data-panel="admin-panel">âš™ï¸ Admin Paneli</button>
</nav>

<main class="main">
<section id="dashboard" class="panel-content">
<div class="card">
<h2>ğŸ“Š Servis Ã–zeti</h2>
<div class="grid-3">
<div class="stat-card"><div class="stat-title">Toplam KayÄ±t</div><div class="stat-value" id="statRecords">0</div></div>
<div class="stat-card"><div class="stat-title">Garanti SÃ¼ren Ä°ÅŸlem</div><div class="stat-value" id="statActiveWarranty">0</div></div>
<div class="stat-card"><div class="stat-title">Bu Ay Eklenen</div><div class="stat-value" id="statThisMonth">0</div></div>
</div>
<div class="card" style="margin-top:25px">
<h3>HaftalÄ±k Ä°ÅŸlem GrafiÄŸi</h3>
<canvas id="visitorsChart" height="100"></canvas>
</div>
</div>
</section>

<section id="records" class="panel-content hidden-panel">
<div class="card">
<h2>ğŸ“‘ Servis KayÄ±tlarÄ±</h2>
<div style="overflow-x:auto;margin-top:20px">
<table class="table" id="recordsTable">
<thead><tr><th>TV Kod/Seri</th><th>Model</th><th>Ä°ÅŸlem</th><th>KayÄ±t Tarihi</th><th>Garanti BitiÅŸ</th><th>Detay</th></tr></thead>
<tbody></tbody>
</table>
</div>
</div>
</section>

<section id="add" class="panel-content hidden-panel">
<div class="card">
<h2>â• Yeni Servis</h2>
<div style="margin-top:20px;">
<div class="form-row"><label class="label">TV Kod/Seri:</label><input id="inpCode" class="input" placeholder="Kod veya Seri" type="text"/></div>
<div class="form-row"><label class="label">TV Model:</label><input id="inpModel" class="input" placeholder="Ã–rn: Samsung QLED 55" type="text"/></div>
<div class="form-row"><label class="label">YapÄ±lan Ä°ÅŸlem:</label>
<select id="inpProcess" class="select">
<option>Led DeÄŸiÅŸim</option>
<option>Panel DeÄŸiÅŸim</option>
<option>Kamera/Barkod</option>
<option>DiÄŸer</option>
</select></div>
<div class="form-row"><label class="label">Ek Not:</label><textarea id="inpNotes" class="textarea"></textarea></div>
<div class="form-row"><label class="label">Garanti BitiÅŸ Tarihi:</label><input id="inpWarrantyDate" class="input" type="date"/></div>
<p class="muted">*(Girilmeyen tarih iÃ§in 1 yÄ±l otomatik garanti uygulanÄ±r. Manuel de yazabilirsiniz.)</p>
<div style="display:flex;gap:10px;margin-top:20px">
<button class="btn" id="addRecordBtn" style="flex:1">KaydÄ± Ekle</button>
<button class="btn btn-secondary" id="clearBtn" style="flex:1">Formu Temizle</button>
</div>
</div>
</div>
</section>

<section id="settings" class="panel-content hidden-panel">
<div class="card">
<h2>ğŸ› ï¸ Ayarlar</h2>
<button id="exportBtn" class="btn">Verileri JSON DÄ±ÅŸa Aktar</button>
</div>
</section>

<section id="admin-panel" class="panel-content hidden-panel">
<div class="card">
<h2>âš™ï¸ Admin Paneli</h2>
<div class="form-row"><label class="label">Vurgu Rengi:</label><input id="color-primary" type="color" value="#FF5733"/></div>
<div class="form-row"><label class="label">Arka Plan:</label><input id="color-bg" type="color" value="#0A0A0A"/></div>
<div class="form-row"><label class="label">Kart Arka PlanÄ±:</label><input id="color-card" type="color" value="#1C1C1C"/></div>
<div class="form-row"><label class="label">Metin Rengi:</label><input id="color-text" type="color" value="#F0F0F0"/></div>
<button class="btn" id="saveColorsBtn" style="margin-top:10px;">Renkleri Uygula</button>
<div class="form-row" style="margin-top:20px;"><label class="label">Admin Åifresi:</label><input id="newAdminCode" type="password" value="6161"/></div>
<button class="btn btn-secondary" id="changeAdminCodeBtn">Åifreyi GÃ¼ncelle</button>
</div>
</section>

<div id="authModal" class="modal">
<div class="modal-box">
<h3>ğŸ”’ Admin GiriÅŸi</h3>
<input id="authCodeInput" type="password" class="input" placeholder="Kod Girin"/>
<div style="display:flex;gap:10px;margin-top:10px;justify-content:flex-end">
<button class="btn btn-secondary" id="authCancel">Ä°ptal</button>
<button class="btn" id="authSubmit">GiriÅŸ</button>
</div>
<p id="authErr" style="color:#dc3545;display:none;margin-top:10px;">Kod hatalÄ±!</p>
</div>
</div>

<script>
const LOCAL_STORAGE_KEY_RECORDS='eroglu_records';
const LOCAL_STORAGE_KEY_COLORS='eroglu_colors';
const LOCAL_STORAGE_KEY_ADMIN='eroglu_admin';
let records=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY_RECORDS)||'[]');
let ADMIN_CODE=localStorage.getItem(LOCAL_STORAGE_KEY_ADMIN)||'6161';
let isAdminLoggedIn=false;

const htmlEl=document.documentElement;
const sidebar=document.getElementById('sidebar');
const hamb=document.getElementById('hambBtn');
const sideBtns=Array.from(document.querySelectorAll('.side-btn[data-panel]'));
const panels={dashboard:document.getElementById('dashboard'),records:document.getElementById('records'),add:document.getElementById('add'),settings:document.getElementById('settings'), 'admin-panel':document.getElementById('admin-panel')};
const recordsTableBody=document.querySelector('#recordsTable tbody');
const authModal=document.getElementById('authModal');

function formatDate(d){return d?new Date(d).toLocaleDateString('tr-TR'):'N/A';}

function loadColors(){
let colors=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY_COLORS)||'{}');
if(colors.primary) htmlEl.style.setProperty('--primary',colors.primary);
if(colors.bg) htmlEl.style.setProperty('--bg',colors.bg);
if(colors.card) htmlEl.style.setProperty('--card',colors.card);
if(colors.text) htmlEl.style.setProperty('--text',colors.text);
document.getElementById('color-primary').value=colors.primary||'#FF5733';
document.getElementById('color-bg').value=colors.bg||'#0A0A0A';
document.getElementById('color-card').value=colors.card||'#1C1C1C';
document.getElementById('color-text').value=colors.text||'#F0F0F0';
renderChart();
}

function saveColors(){
const newColors={primary:document.getElementById('color-primary').value,bg:document.getElementById('color-bg').value,card:document.getElementById('color-card').value,text:document.getElementById('color-text').value};
localStorage.setItem(LOCAL_STORAGE_KEY_COLORS,JSON.stringify(newColors));
loadColors();
alert('Renkler kaydedildi!');
}

function renderRecords(){
recordsTableBody.innerHTML='';
records.forEach((r,i)=>{
let warranty=new Date(r.warrantyDate),today=new Date();
let active=warranty>today?'active':'passive';
let tr=document.createElement('tr');
tr.innerHTML=`<td>${r.code}</td><td>${r.model}</td><td>${r.process}</td><td>${formatDate(r.created)}</td><td><span class="badge ${active}">${formatDate(r.warrantyDate)}</span></td><td><button onclick="viewNotes(${i})" class="btn btn-secondary">Detay</button> <button onclick="delRecord(${i})" class="btn btn-secondary">Sil</button></td>`;
recordsTableBody.appendChild(tr);
document.getElementById('statRecords').innerText=records.length;
document.getElementById('statActiveWarranty').innerText=records.filter(r=>new Date(r.warrantyDate)>today).length;
document.getElementById('statThisMonth').innerText=records.filter(r=>new Date(r.created).getMonth()==today.getMonth() && new Date(r.created).getFullYear()==today.getFullYear()).length;
});
}

function viewNotes(i){alert(records[i].notes||'Not yok.');}
function delRecord(i){if(confirm('Silinsin mi?')){records.splice(i,1);localStorage.setItem(LOCAL_STORAGE_KEY_RECORDS,JSON.stringify(records));renderRecords();}}

document.getElementById('addRecordBtn').addEventListener('click',()=>{
let code=document.getElementById('inpCode').value.trim();
let model=document.getElementById('inpModel').value.trim();
let process=document.getElementById('inpProcess').value;
let notes=document.getElementById('inpNotes').value.trim();
let warranty=document.getElementById('inpWarrantyDate').value;
if(!code||!model){alert('Kod ve Model gerekli!');return;}
warranty=warranty?warranty:new Date(new Date().setFullYear(new Date().getFullYear()+1)).toISOString();
records.push({code,model,process,notes,created:new Date().toISOString(),warrantyDate:warranty});
localStorage.setItem(LOCAL_STORAGE_KEY_RECORDS,JSON.stringify(records));
document.getElementById('inpCode').value='';
document.getElementById('inpModel').value='';
document.getElementById('inpProcess').value='Led DeÄŸiÅŸim';
document.getElementById('inpNotes').value='';
document.getElementById('inpWarrantyDate').value='';
renderRecords();
showPanel('records');
});

document.getElementById('clearBtn').addEventListener('click',()=>{document.getElementById('inpCode').value='';document.getElementById('inpModel').value='';document.getElementById('inpProcess').value='Led DeÄŸiÅŸim';document.getElementById('inpNotes').value='';document.getElementById('inpWarrantyDate').value='';});

document.getElementById('exportBtn').addEventListener('click',()=>{
let data='data:application/json;charset=utf-8,'+encodeURIComponent(JSON.stringify(records,null,2));
let a=document.createElement('a');a.href=data;a.download='eroglu_records.json';a.click();
});

function showAuthModal(){authModal.classList.add('visible');document.getElementById('authCodeInput').value='';document.getElementById('authErr').style.display='none';}
function handleAuthSubmit(){let val=document.getElementById('authCodeInput').value.trim();if(val===ADMIN_CODE){isAdminLoggedIn=true;authModal.classList.remove('visible');showPanel('admin-panel');}else{document.getElementById('authErr').style.display='block';}}

document.getElementById('authSubmit').addEventListener('click',handleAuthSubmit);
document.getElementById('authCancel').addEventListener('click',()=>authModal.classList.remove('visible'));
